<!DOCTYPE html>

<head>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <!-- Make sure you put this AFTER Leaflet's CSS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script src="../../docs/places.js"></script>
  <style>
    #map {
      height: 95vh;
      width: 98vw;
    }
  </style>
</head>

<body>
  <div id="map"></div>

  <script>
    // Reference: https://stackoverflow.com/questions/11652681/replacing-umlauts-in-js
    const fixUmlauts = v => {
      v = v.replace(/ä/g, '&auml;');
      v = v.replace(/ö/g, '&ouml;');
      v = v.replace(/ü/g, '&uuml;');
      v = v.replace(/ß/g, '&szlig;');
      v = v.replace(/Ä/g, '&Auml;');
      v = v.replace(/Ö/g, '&Ouml;');
      v = v.replace(/Ü/g, '&Uuml;');
      return v;
    }
  </script>

  <script>

    // Magdeburg Hauptbahnhof
    const origin = [52.130692, 11.626788];

    var map = L.map('map').setView(origin, 7);

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    }).addTo(map);

    const addCircle = (name, latlng, radius) => {
      var circle = L.circle(latlng, {
        color: '#3333ff',
        fillColor: '#2200aa',
        fillOpacity: 0.2,
        radius: radius
      }).addTo(map);
      circle.bindPopup(name);
    }

    places.forEach(p => {
      name = fixUmlauts(p[0]);
      latlng = p.slice(2, 4);
      radius = Math.sqrt(p[1] * 15000000);
      addCircle(name, latlng, radius);
    });
  </script>
</body>